/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
import{isSome as t}from"../core/maybe.js";import{clamp as n}from"../core/mathUtils.js";import{c as r}from"./vec3f64.js";import{g as e,d as o,a as i,f as s,m as c,n as u,c as a,b as f}from"./vec3.js";import{sv4d as m,sv3d as g}from"../views/3d/support/stack.js";import{g as p}from"./sphere.js";function l(t=T){return[t[0],t[1],t[2],t[3]]}function d(t,n,r,e){return h(t,n,r,e,m.get())}function y(t,n=l()){return h(t[0],t[1],t[2],t[3],n)}function h(t,n,r,e,o=l()){return o[0]=t,o[1]=n,o[2]=r,o[3]=e,o}function j(t,n,r=l()){return e(r,t),r[3]=n,r}function P(t,n,r=l()){e(r,n);const s=o(n,n);return Math.abs(s-1)>1e-5&&s>1e-12&&i(r,r,1/Math.sqrt(s)),I(r,t,r),r}function M(t,n,r,e=l()){return w(s(g.get(),t,n),s(g.get(),r,n),t,e)}function b(t,n){return v(t,n,0,1,2)}function v(t,n,r,e,i){if(t.count<3)return!1;t.getVec(r,V);let a=e,f=!1;for(;a<t.count-1&&!f;)t.getVec(a,O),a++,f=!c(V,O);if(!f)return!1;for(a=Math.max(a,i),f=!1;a<t.count&&!f;)t.getVec(a,S),a++,s(x,V,O),u(x,x),s(F,O,S),u(F,F),f=!c(V,S)&&!c(O,S)&&Math.abs(o(x,F))<A;return f?(M(V,O,S,n),!0):(0!==r||1!==e||2!==i)&&v(t,n,0,1,2)}const A=.99619469809,V=r(),O=r(),S=r(),x=r(),F=r();function I(t,n,r){return t!==r&&y(t,r),r[3]=-o(Q(r),n),r}function _(t,n){return n[0]=-t[0],n[1]=-t[1],n[2]=-t[2],n[3]=-t[3],n}function w(t,n,r,e=l()){return P(r,a(g.get(),n,t),e)}function B(n,r,e){return!!t(r)&&K(n,r.origin,r.direction,!0,!1,e)}function U(t,n,r){return K(t,n.origin,n.vector,!1,!1,r)}function k(t,n,r){return K(t,n.origin,n.vector,!1,!0,r)}function q(t,n){return J(t,p(n))-n[3]>=0}function z(t,n){return J(t,p(n))+n[3]<0}function L(t,n){return J(t,n)>=0}function N(t,n){return J(t,n)<0}function C(t,n){const r=n[0],e=n[1],o=n[2],i=n[3],s=n[4],c=n[5];return t[0]*(t[0]>0?r:i)+t[1]*(t[1]>0?e:s)+t[2]*(t[2]>0?o:c)+t[3]>=0}function D(t,n){const r=o(Q(t),n.ray.direction),e=-J(t,n.ray.origin);if(e<0&&r>=0)return!1;if(r>-1e-6&&r<1e-6)return e>0;if((e<0||r<0)&&!(e<0&&r<0))return!0;const i=e/r;return r>0?i<n.c1&&(n.c1=i):i>n.c0&&(n.c0=i),n.c0<=n.c1}function R(t,n){const r=o(Q(t),n.ray.direction),e=-J(t,n.ray.origin);if(r>-1e-6&&r<1e-6)return e>0;const i=e/r;return r>0?i<n.c1&&(n.c1=i):i>n.c0&&(n.c0=i),n.c0<=n.c1}function E(t,n,r){const e=i(g.get(),Q(t),-t[3]),o=G(t,s(g.get(),n,e),g.get());return f(r,o,e),r}function G(t,n,r){const e=i(g.get(),Q(t),o(Q(t),n));return s(r,n,e),r}function H(t,n){return Math.abs(J(t,n))}function J(t,n){return o(Q(t),n)+t[3]}function K(t,r,e,s,c,u){const a=o(Q(t),e);if(0===a)return!1;let m=-(o(Q(t),r)+t[3])/a;return c&&(m=s?Math.max(0,m):n(m,0,1)),!(m<0||!s&&m>1)&&(f(u,r,i(u,e,m)),!0)}function Q(t){return t}const T=[0,0,1,0];var W=Object.freeze({__proto__:null,create:l,wrap:d,copy:y,fromValues:h,fromNormalAndOffset:j,fromPositionAndNormal:P,fromPoints:M,fromManyPoints:b,fromManyPointsSampleAt:v,setOffsetFromPoint:I,negate:_,fromVectorsAndPoint:w,intersectRay:B,intersectLineSegment:U,intersectLineSegmentClamp:k,isSphereFullyInside:q,isSphereFullyOutside:z,isPointInside:L,isPointOutside:N,isAABBFullyInside:C,clip:D,clipInfinite:R,projectPoint:E,projectVector:G,distance:H,signedDistance:J,normal:Q,UP:T});export{G as A,H as B,T as U,y as a,h as b,l as c,U as d,k as e,w as f,L as g,W as h,B as i,M as j,q as k,R as l,J as m,Q as n,C as o,E as p,D as q,N as r,I as s,v as t,j as u,P as v,d as w,b as x,_ as y,z};
