/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
import e from"../../../core/Logger.js";import{Z as t,c as r}from"../../../chunks/vec3f64.js";import{a as o}from"../../../chunks/vec3.js";import{getSphericalPCPF as i}from"../../projectionEllipsoid.js";import{projectPointToVector as n}from"../../projection.js";import{projectToECEF as s,projectNormalToECEF as c,projectTangentToECEF as a,projectFromECEF as p,projectNormalFromECEF as f,projectTangentFromECEF as l}from"./projection.js";const g=e.getLogger("esri.geometry.support.meshUtils.scale");function m(e,t,r){if(!e.vertexAttributes||!e.vertexAttributes.position)return;const o=e.spatialReference,i=o.isWGS84||o.isWebMercator&&(!r||!1!==r.geographic),n=r&&r.origin||e.extent.center;i?u(e,t,n):x(e,t,n)}function u(e,t,r){const o=e.spatialReference,g=i(o),m=d;n(r,m,g)||n(e.extent.center,m,g);const u=e.vertexAttributes.position,x=e.vertexAttributes.normal,A=e.vertexAttributes.tangent,j=new Float64Array(u.length),v=new Float32Array(x?x.length:0),b=new Float32Array(A?A.length:0);s(u,o,j),x&&c(x,u,j,o,v),A&&a(A,u,j,o,b),h(j,t,m),p(j,u,o),x&&f(v,u,j,o,x),A&&l(b,u,j,o,A),e.vertexAttributesChanged()}function x(e,t,r){const o=d;if(!n(r,o,e.spatialReference)){const t=e.extent.center;o[0]=t.x,o[1]=t.y,o[2]=t.z,g.error(`Failed to project specified origin (wkid:${r.spatialReference.wkid}) to mesh spatial reference (wkid:${e.spatialReference.wkid}). Using mesh extent.center instead`)}h(e.vertexAttributes.position,t,o),e.vertexAttributesChanged()}function h(e,r,i=t){if(e)for(let t=0;t<e.length;t+=3){for(let r=0;r<3;r++)A[r]=e[t+r]-i[r];o(A,A,r);for(let r=0;r<3;r++)e[t+r]=A[r]+i[r]}}const A=r(),d=r();export{m as scale};
