/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
import e from"../../../../../core/CircularArray.js";import{UpdateToken as s}from"../support/UpdateToken.js";class t{constructor(s){this.requests={done:new Array,stream:new e(10)},this._abortController=new AbortController,this.didSend=!1,this.tile=s}get invalid(){return this._invalid}get signal(){return this._abortController.signal}get options(){return{signal:this._abortController.signal}}sentEnd(){return this.requests.done.some((e=>e.message.end))}clear(){this.requests.done=[]}applyUpdate(e){this.requests.done.forEach((s=>s.message.status.unset(e)))}invalidate(e){switch(e){case"fields":return void("none"===this._invalid&&(this._invalid="fields"));case"all":return void(this._invalid="all")}}done(){this._invalid="none"}add(e){var t;e.message.status=null!=(t=e.message.status)?t:s.empty(),this.requests.done.push(e),e.message.end&&(this.resolved=!0)}abort(){this._abortController.abort()}}export{t as DataTileSubscription};
