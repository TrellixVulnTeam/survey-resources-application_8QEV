/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
import{makeHandle as e}from"../../../core/handleUtils.js";import r from"../../../geometry/Point.js";import t from"../../../geometry/Polyline.js";import"../../../geometry.js";import i from"../../../symbols/CIMSymbol.js";import{px2pt as o}from"../../../core/screenUtils.js";import n from"../../../symbols/SimpleLineSymbol.js";import a from"../../../symbols/SimpleMarkerSymbol.js";import"../../../symbols.js";import l from"../../../Graphic.js";import{c as s}from"../../../chunks/vec3f64.js";import{a as m}from"../../../chunks/vec2f64.js";import{d as p,f as y}from"../../../chunks/vec2.js";import{colors as c}from"../../draw/support/settings.js";import{defaults as b}from"../../interactive/snapping/Settings.js";import{SnappingVisualizer as g}from"../../interactive/snapping/SnappingVisualizer.js";class S extends g{visualizeIntersectionPoint(e,t){return this._visualizeSnappingIndicator({geometry:new r({x:e.intersectionPoint[0],y:e.intersectionPoint[1],spatialReference:t.coordinateHelper.spatialReference}),symbol:M,context:t})}visualizePoint(e,t){return this._visualizeSnappingIndicator({geometry:new r({x:e.point[0],y:e.point[1],spatialReference:t.coordinateHelper.spatialReference}),symbol:u,context:t})}visualizeLine(e,r){return this._visualizeSnappingIndicator({geometry:new t({paths:[[e.lineStart,e.lineEnd]],spatialReference:r.coordinateHelper.spatialReference}),symbol:x,context:r})}visualizeParallelSign(e,r){return this._visualizeSnappingIndicator({geometry:new t({paths:[[e.lineStart,e.lineEnd]],spatialReference:r.coordinateHelper.spatialReference}),symbol:f,context:r})}visualizeRightAngleQuad(e,r){return this._visualizeSnappingIndicator({geometry:new t({paths:[[e.previousVertex,e.centerVertex,e.nextVertex]],spatialReference:r.coordinateHelper.spatialReference}),symbol:C(e),context:r})}_visualizeSnappingIndicator(r){const{geometry:t,symbol:i,context:o}=r,n=new l({geometry:t,symbol:i});return o.view.graphics.add(n),e((()=>{o.view.graphics.remove(n)}))}}const d=c.main.toArray(),h=[...c.main.toRgb(),100],M=new a({outline:new n({width:1.5,color:d}),size:15,color:[0,0,0,0]}),u=new a({outline:{width:.5,color:[0,0,0,1]},size:10,color:d}),x=new i({data:{type:"CIMSymbolReference",symbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",enable:!0,capStyle:"Butt",joinStyle:"Round",miterLimit:10,width:o(b.lineHintWidthTarget),color:d}]}}}),f=new i({data:{type:"CIMSymbolReference",symbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,anchorPoint:{x:0,y:-1,z:0},anchorPointUnits:"Relative",size:5,markerPlacement:{type:"CIMMarkerPlacementOnLine",placePerPart:!0,angleToLine:!0,relativeTo:"LineMiddle"},frame:{xmin:-5,ymin:-1.5,xmax:5,ymax:1.5},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{rings:[[[7,0],[-7,0],[-7,1.5],[7,1.5]]]},symbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:d}]}}],scaleSymbolsProportionally:!0,respectFrame:!0},{type:"CIMVectorMarker",enable:!0,anchorPoint:{x:0,y:1,z:0},anchorPointUnits:"Relative",size:5,markerPlacement:{type:"CIMMarkerPlacementOnLine",placePerPart:!0,angleToLine:!0,relativeTo:"LineMiddle"},frame:{xmin:-5,ymin:-1.5,xmax:5,ymax:1.5},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{rings:[[[7,0],[-7,0],[-7,-1.5],[7,-1.5]]]},symbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:d}]}}],scaleSymbolsProportionally:!0,respectFrame:!0}]}}}),I=e=>new i({data:{type:"CIMSymbolReference",symbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,anchorPoint:{x:.5,y:.5,z:0},anchorPointUnits:"Relative",size:o(b.rightAngleHintSize),rotation:e,markerPlacement:{type:"CIMMarkerPlacementOnVertices",placePerPart:!0,angleToLine:!0,placeOnEndPoints:!1},frame:{xmin:-5,ymin:-5,xmax:5,ymax:5},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{paths:[[[5,-5],[-5,-5],[-5,5],[5,5],[5,-5]]]},symbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",enable:!0,capStyle:"Butt",joinStyle:"Round",miterLimit:10,width:o(b.rightAngleHintOutlineSize),color:d},{type:"CIMSolidFill",enable:!0,color:h}]}}],scaleSymbolsProportionally:!0,respectFrame:!0}]}}}),P=I(45),v=I(225),C=(()=>{const e=m(),r=m(),t=s();return i=>(p(e,i.centerVertex,i.previousVertex),p(r,i.nextVertex,i.previousVertex),y(t,e,r),t[2]<0?P:v)})();export{S as SnappingVisualizer2D};
