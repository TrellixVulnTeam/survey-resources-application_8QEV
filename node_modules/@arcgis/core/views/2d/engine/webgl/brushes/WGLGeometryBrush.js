/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
import{isNone as t}from"../../../../../core/maybe.js";import{TEXTURE_BINDING_ATTRIBUTE_DATA_0 as e,TEXTURE_BINDING_ATTRIBUTE_DATA_1 as i,TEXTURE_BINDING_ATTRIBUTE_DATA_2 as a,TEXTURE_BINDING_ATTRIBUTE_DATA_3 as r}from"../definitions.js";import s from"./WGLBrush.js";class n extends s{prepareState({context:t},e,i){const a=i&&-1!==i.indexOf("id");t.setBlendingEnabled(!a),t.setBlendFunctionSeparate(1,771,1,771),t.setColorMask(!0,!0,!0,!0),t.setStencilWriteMask(0),t.setStencilTestEnabled(!0),t.setStencilFunction(514,e.stencilRef,255)}draw(e,i,a){const r=this.getGeometryType();i.commit(e);const s=i.getGeometry(r);t(s)||(e.timeline.begin(this.name),e.attributeView.bindTextures(e.context),s.forEachCommand((t=>this.drawGeometry(e,i,t,a))))}_setSharedUniforms(t,s,n){t.setUniform1f("u_pixelRatio",s.pixelRatio),t.setUniformMatrix3fv("u_dvsMat3",n.transforms.dvs),t.setUniformMatrix3fv("u_displayViewMat3",s.state.displayViewMat3),t.setUniform1i("u_attributeTextureSize",s.attributeView.size),t.setUniform1i("u_attributeData0",e),t.setUniform1i("u_attributeData1",i),t.setUniform1i("u_attributeData2",a),t.setUniform1i("u_attributeData3",r)}}export default n;
