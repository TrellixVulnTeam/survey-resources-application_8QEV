/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
import"../../../../../core/has.js";import"../../../../../core/mathUtils.js";import{f as t}from"../../../../../chunks/vec4f32.js";import"../../../../../chunks/builtins.js";import r from"../../../../webgl/BufferObject.js";import e from"../../../../webgl/VertexArrayObject.js";import"../../../../webgl/FramebufferObject.js";import{createProgram as i}from"../../../../webgl/programUtils.js";import s from"./WGLBrush.js";import{background as o}from"../shaders/BackgroundPrograms.js";class a extends s{constructor(){super(...arguments),this._color=t(1,0,0,1),this._initialized=!1}dispose(){this._solidProgram&&(this._solidProgram.dispose(),this._solidProgram=null),this._solidVertexArrayObject&&(this._solidVertexArrayObject.dispose(),this._solidVertexArrayObject=null)}prepareState({context:t},r){t.setDepthWriteEnabled(!1),t.setDepthTestEnabled(!1),t.setStencilTestEnabled(!0),t.setBlendingEnabled(!1),t.setColorMask(!1,!1,!1,!1),t.setStencilOp(7680,7680,7681),t.setStencilWriteMask(255),t.setStencilFunctionSeparate(1032,516,r.stencilRef,255)}draw(t,r){const{context:e}=t;this._initialized||this._initialize(e),e.bindVAO(this._solidVertexArrayObject),e.bindProgram(this._solidProgram),this._solidProgram.setUniformMatrix3fv("u_dvsMat3",r.transforms.dvs),this._solidProgram.setUniform2fv("u_coord_range",r.coordRange),this._solidProgram.setUniform1f("u_depth",0),this._solidProgram.setUniform4fv("u_color",this._color),e.drawArrays(5,0,4),e.bindVAO()}_initialize(t){if(this._initialized)return!0;const s=i(t,o);if(!s)return!1;const a={geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:2,normalized:!1,divisor:0}]},n=new Int8Array([0,0,1,0,0,1,1,1]),l=r.createVertex(t,35044,n),d=new e(t,o.attributes,a,{geometry:l});return this._solidProgram=s,this._solidVertexArrayObject=d,this._initialized=!0,!0}}export default a;
