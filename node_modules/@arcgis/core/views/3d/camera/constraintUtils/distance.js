/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
import{c as t}from"../../../../chunks/vec3f64.js";import{k as e,g as r,f as n,b as i}from"../../../../chunks/vec3.js";import{directionFromTo as o}from"../../support/mathUtils.js";import{sphere as s,ray as c}from"../../support/geometryUtils.js";import{defaultApplyOptions as a,interactionDirectionTowardsConstraintMinimization as f,adjustRangeForInteraction as m}from"./common.js";function u(t,e,r=a){if(!t.state.isLocal)return 0;const n=t.state.constraints.distance;if(!t.pointsOfInterest.surfaceOrigin.renderLocation||n===1/0)return 0;g.min=0,g.max=n,d(t,r,g);const i=y(t,e),o=g.max-i;return o>=-1e-6?0:o}function p(t,e,o=a){const m=u(t,e,o);if(0===m)return!1;const p=t.pointsOfInterest.surfaceOrigin,d=y(t,e)+m,g=r(l,e.eye),I=f(e,o.interactionDirection,O(t,e,k),j);if(s.intersectRay(s.fromCenterAndRadius(p.renderLocation,d),c.wrap(e.eye,I),e.eye)){const r=n(x,e.eye,g);i(e.center,e.center,r),e.markViewDirty();const o=t.renderCoordsHelper.getAltitude(e.center);return t.renderCoordsHelper.intersectInfiniteManifold(e.ray,o,e.center),e.markViewDirty(),!0}return!1}function d(t,e,r){const n=e.interactionType;if(0===n)return;const{min:i,max:o}=r,{interactionStartCamera:s,interactionFactor:c}=e,a=1===n||4===n,f=u(t,s),p=0===f?0:y(t,s);r.min=i,r.max=o;m(f,p,a,c,.05*p,r)}function y(t,r){const n=t.pointsOfInterest.surfaceOrigin;return e(r.eye,n.renderLocation)}function O(t,e,r){const n=t.pointsOfInterest.surfaceOrigin;return o(r,e.eye,n.renderLocation)}const g={min:0,max:0},l=t(),x=t(),j=t(),k=t();export{p as applyDistanceConstraint,u as getDistanceConstraintError};
