/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
import{isSome as e}from"../../../../core/maybe.js";import t from"../../../../core/Evented.js";import{nextHighestPowerOfTwo as r}from"../../../../core/mathUtils.js";import{ContentObject as i}from"./ContentObject.js";import s from"../../../webgl/capabilities/isWebGL2Context.js";import h from"../../../webgl/Texture.js";import{TextRenderer as n,getTextHelperCanvas as d}from"./TextRenderer.js";class o extends i{constructor(e,r,i){super(),this.type=4,this._glTexture=null,this.events=new t,this._requiresPowerOfTwo=!s(e.gl),this._renderer=new n(r,i)}get width(){return this._renderer.renderedWidth}get height(){return this._renderer.renderedHeight}get textureWidth(){const e=this.width;return this._requiresPowerOfTwo?r(e):e}get textureHeight(){const e=this.height;return this._requiresPowerOfTwo?r(e):e}get displayWidth(){return this._renderer.displayWidth}get displayHeight(){return this._renderer.displayHeight}get texcoordScale(){return[this._renderer.renderedWidth/this.textureWidth,this._renderer.renderedHeight/this.textureHeight]}get requiresFrameUpdates(){return!1}createDescriptor(e){return{target:3553,pixelFormat:6408,dataType:5121,wrapMode:33071,flipped:!0,samplingMode:9987,hasMipmap:!0,preMultiplyAlpha:!0,maxAnisotropy:e.parameters.maxMaxAnisotropy}}load(t){if(e(this._glTexture))return this._glTexture;const r=d(u,this.textureWidth,this.textureHeight),i=r.getContext("2d");return i.save(),this._renderer.render(i,0,this.textureHeight-this._renderer.renderedHeight),this._glTexture=new h(t,this.createDescriptor(t),r),i.restore(),this._glTexture}unload(){e(this._glTexture)&&(this._glTexture.dispose(),this._glTexture=null),this.events.emit("unloaded")}}const u={canvas:null};export default o;
