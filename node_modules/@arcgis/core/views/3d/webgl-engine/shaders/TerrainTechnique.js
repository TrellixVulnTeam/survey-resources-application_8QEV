/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
import{_ as e}from"../../../../chunks/tslib.es6.js";import{ReloadableShaderModule as r}from"../core/shaderTechnique/ReloadableShaderModule.js";import{ShaderTechnique as t}from"../core/shaderTechnique/ShaderTechnique.js";import{ShaderTechniqueConfiguration as o,parameter as i}from"../core/shaderTechnique/ShaderTechniqueConfiguration.js";import{Default3D as d}from"../lib/DefaultVertexAttributeLocations.js";import s from"../../../webgl/Program.js";import{makePipelineState as n,simpleBlendingParams as l,backFaceCullingParams as a,defaultDepthWriteParams as c,defaultColorWriteParams as u}from"../../../webgl/renderState.js";import{renderWhenBitIsNotSet as p}from"../lib/StencilUtils.js";import{T as h}from"../../../../chunks/Terrain.glsl.js";class b extends t{initializeProgram(e){const r=b.shader.get(),t=this.configuration,o=r.build({overlayMode:t.overlayMode,output:t.output,viewingMode:e.viewingMode,slicePlaneEnabled:t.slicePlaneEnabled,sliceHighlightDisabled:!1,sliceEnabledForVertexPrograms:!1,textureFadingEnabled:t.textureFadingEnabled&&!t.renderOccluded,hasBackgroundColor:t.hasBackgroundColor,useGrid:t.useGrid,receiveShadows:t.receiveShadows&&!t.renderOccluded,receiveAmbientOcclusion:!1,useOldSceneLightInterface:!0,atmosphere:t.atmosphere,tileBorders:t.tileBorders,screenSizePerspective:t.screenSizePerspective,pbrMode:0,ssrEnabled:t.ssrEnabled,highStepCount:!1});return new s(e.rctx,o.generateSource("vertex"),o.generateSource("fragment"),d)}initializePipeline(){const e=this.configuration,r=e.backfaceCullingEnabled&&!e.renderOccluded;return n({blending:e.renderOccluded?l(1,771):null,culling:r&&a,depthTest:!e.renderOccluded&&{func:513},depthWrite:!e.renderOccluded&&c,colorWrite:u,stencilTest:e.stencilEnabled?p(1):null})}}b.shader=new r(h,(()=>import("../core/shaderLibrary/terrain/Terrain.glsl.js")));class g extends o{constructor(){super(...arguments),this.output=0,this.overlayMode=0,this.atmosphere=!1,this.receiveShadows=!1,this.slicePlaneEnabled=!1,this.backfaceCullingEnabled=!1,this.stencilEnabled=!1,this.textureFadingEnabled=!1,this.hasBackgroundColor=!1,this.useGrid=!1,this.renderOccluded=!1,this.ssrEnabled=!1,this.tileBorders=!1,this.screenSizePerspective=!1}}e([i({count:8})],g.prototype,"output",void 0),e([i({count:3})],g.prototype,"overlayMode",void 0),e([i()],g.prototype,"atmosphere",void 0),e([i()],g.prototype,"receiveShadows",void 0),e([i()],g.prototype,"slicePlaneEnabled",void 0),e([i()],g.prototype,"backfaceCullingEnabled",void 0),e([i()],g.prototype,"stencilEnabled",void 0),e([i()],g.prototype,"textureFadingEnabled",void 0),e([i()],g.prototype,"hasBackgroundColor",void 0),e([i()],g.prototype,"useGrid",void 0),e([i()],g.prototype,"renderOccluded",void 0),e([i()],g.prototype,"ssrEnabled",void 0),e([i()],g.prototype,"tileBorders",void 0),e([i()],g.prototype,"screenSizePerspective",void 0);export{b as TerrainTechnique,g as TerrainTechniqueConfiguration};
