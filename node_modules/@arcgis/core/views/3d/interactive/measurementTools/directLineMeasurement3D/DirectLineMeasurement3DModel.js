/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
import{_ as e}from"../../../../../chunks/tslib.es6.js";import"../../../../../core/has.js";import{isSome as t}from"../../../../../core/maybe.js";import"../../../../../core/Logger.js";import"../../../../../core/accessorSupport/ensureType.js";import{property as o}from"../../../../../core/accessorSupport/decorators/property.js";import{aliasOf as r}from"../../../../../core/accessorSupport/decorators/aliasOf.js";import{subclass as s}from"../../../../../core/accessorSupport/decorators/subclass.js";import"../../../../../core/urlUtils.js";import"../../../../../core/uuid.js";import"../../../../../portal/support/resourceExtension.js";import i from"../../../../../core/Accessor.js";import a from"../../../../../geometry/Point.js";import n from"../../../../../core/Handles.js";import{PropertiesPool as c}from"../../../support/PropertiesPool.js";import{DirectLineMeasurement3D as u}from"../../graphics/DirectLineMeasurement3D/DirectLineMeasurement3D.js";let l=class extends i{constructor(){super(...arguments),this._handles=new n,this._propertiesPool=new c({startPoint:a,endPoint:a},this),this.model=new u,this.cursorPoint=null,this.state="initial",this.active=!1,this.geodesicMeasurementDistanceThreshold=1e5}initialize(){this.sceneView.analyses.add(this.model),this.reset()}destroy(){this._handles.destroy(),this._handles=null,this.sceneView.analyses.remove(this.model),this._propertiesPool.destroy(),this._propertiesPool=null,this.model.destroy()}set startPointSurfaceLocation(e){this._set("startPointSurfaceLocation",e)}set endPointSurfaceLocation(e){this._set("endPointSurfaceLocation",e)}get measurementSurfaceLocation(){const e=this.startPointSurfaceLocation,t=this.endPointSurfaceLocation;return null==e||null==t||"above-the-surface"===e&&"below-the-surface"===t||"below-the-surface"===e&&"above-the-surface"===t||"on-the-surface"===e&&"on-the-surface"===t?"camera-dependent":"above-the-surface"===e||"above-the-surface"===t?"above-the-surface":"below-the-surface"}get validMeasurement(){return t(this.model.startPoint)&&t(this.model.endPoint)}get isMeasuring(){return!!this.startPoint}get geodesicDistanceExceeded(){return t(this.model.measurement)&&this.model.measurement.horizontalDistance&&this.model.measurement.horizontalDistance.value>this.geodesicMeasurementDistanceThreshold}reset(){this.clearMeasurement()}clearMeasurement(){this.state="initial",this.startPoint=null,this.endPoint=null,this.cursorPoint=null,this._clearOverride("measurementSurfaceLocation")}finishMeasurement(){if(!this._isOverridden("measurementSurfaceLocation")){const e=this.measurementSurfaceLocation,t="camera-dependent"===e?this.sceneView.state.camera.aboveGround?"above-the-surface":"below-the-surface":e;this._override("measurementSurfaceLocation",t)}this.state="measured"}};e([o()],l.prototype,"messages",void 0),e([o({constructOnly:!0})],l.prototype,"sceneView",void 0),e([o()],l.prototype,"model",void 0),e([r("model.startPoint")],l.prototype,"startPoint",void 0),e([o({value:null})],l.prototype,"startPointSurfaceLocation",null),e([r("model.endPoint")],l.prototype,"endPoint",void 0),e([o({value:null})],l.prototype,"endPointSurfaceLocation",null),e([o()],l.prototype,"measurementSurfaceLocation",null),e([o()],l.prototype,"cursorPoint",void 0),e([o()],l.prototype,"state",void 0),e([r("model.settings.unit")],l.prototype,"unit",void 0),e([o()],l.prototype,"active",void 0),e([o({readOnly:!0})],l.prototype,"validMeasurement",null),e([o({readOnly:!0})],l.prototype,"isMeasuring",null),e([o()],l.prototype,"geodesicMeasurementDistanceThreshold",void 0),e([o({readOnly:!0})],l.prototype,"geodesicDistanceExceeded",null),l=e([s("esri.views.3d.interactive.measurementTools.directLineMeasurement3D.DirectLineMeasurement3DModel")],l);var m=l;export default m;
