/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
import{_ as e}from"../../chunks/tslib.es6.js";import"../../core/has.js";import"../../core/Logger.js";import"../../core/accessorSupport/ensureType.js";import{property as t}from"../../core/accessorSupport/decorators/property.js";import{aliasOf as s}from"../../core/accessorSupport/decorators/aliasOf.js";import{subclass as r}from"../../core/accessorSupport/decorators/subclass.js";import"../../core/urlUtils.js";import"../../core/uuid.js";import"../../portal/support/resourceExtension.js";import{init as i}from"../../core/watchUtils.js";import"../support/widgetUtils.js";import{messageBundle as o}from"../support/decorators/messageBundle.js";import{j as l}from"../../chunks/index.js";import a from"../Widget.js";import d from"./support/FeatureElementInfo.js";import n from"./FeatureFields/FeatureFieldsViewModel.js";import{autoLink as p}from"../support/uriUtils.js";const f={base:"esri-feature-fields",fieldHeader:"esri-feature-fields__field-header",fieldData:"esri-feature-fields__field-data",fieldDataDate:"esri-feature-fields__field-data--date",esriTable:"esri-widget__table"};let u=class extends a{constructor(e,t){super(e,t),this._featureElementInfo=null,this.attributes=null,this.description=null,this.expressionInfos=null,this.fieldInfos=null,this.title=null,this.viewModel=new n,this.messages=null,this.messagesURIUtils=null}initialize(){this._featureElementInfo=new d,i(this,["viewModel.description","viewModel.title"],(()=>this._setupFeatureElementInfo()))}destroy(){this._featureElementInfo.destroy()}renderFieldInfo(e,t){const{attributes:s}=this.viewModel,r=e.fieldName,i=e.label||r,o=s?null==s[r]?"":s[r]:"",a=!(!e.format||!e.format.dateFormat),d="number"==typeof o&&!a?this._forceLTR(o):p(this.messagesURIUtils,o),n={[f.fieldDataDate]:a};return l("tr",{key:`fields-element-info-row-${r}-${t}`},l("th",{key:`fields-element-info-row-header-${r}-${t}`,class:f.fieldHeader,innerHTML:i}),l("td",{key:`fields-element-info-row-data-${r}-${t}`,class:this.classes(f.fieldData,n),innerHTML:d}))}renderFields(){const{formattedFieldInfos:e}=this.viewModel;return e.length?l("table",{class:f.esriTable,summary:this.messages.fieldsSummary},l("tbody",null,e.map(((e,t)=>this.renderFieldInfo(e,t))))):null}render(){var e;return l("div",{class:f.base},null==(e=this._featureElementInfo)?void 0:e.render(),this.renderFields())}_setupFeatureElementInfo(){const{description:e,title:t}=this;this._featureElementInfo.set({description:e,title:t})}_forceLTR(e){return`&lrm;${e}`}};e([s("viewModel.attributes")],u.prototype,"attributes",void 0),e([s("viewModel.description")],u.prototype,"description",void 0),e([s("viewModel.expressionInfos")],u.prototype,"expressionInfos",void 0),e([s("viewModel.fieldInfos")],u.prototype,"fieldInfos",void 0),e([s("viewModel.title")],u.prototype,"title",void 0),e([t({type:n})],u.prototype,"viewModel",void 0),e([t(),o("esri/widgets/Feature/t9n/Feature")],u.prototype,"messages",void 0),e([t(),o("esri/widgets/support/t9n/uriUtils")],u.prototype,"messagesURIUtils",void 0),u=e([r("esri.widgets.Feature.FeatureFields")],u);var m=u;export default m;
