/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
import{_ as e}from"../chunks/tslib.es6.js";import"../core/has.js";import"../core/Logger.js";import"../core/accessorSupport/ensureType.js";import{property as s}from"../core/accessorSupport/decorators/property.js";import{aliasOf as a}from"../core/accessorSupport/decorators/aliasOf.js";import{subclass as t}from"../core/accessorSupport/decorators/subclass.js";import"../core/urlUtils.js";import"../core/uuid.js";import"../portal/support/resourceExtension.js";import{getAssetUrl as i}from"../assets.js";import r from"../core/Handles.js";import{on as o,whenOnce as l}from"../core/watchUtils.js";import"./support/widgetUtils.js";import{accessibleHandler as m}from"./support/decorators/accessibleHandler.js";import{messageBundle as d}from"./support/decorators/messageBundle.js";import{j as p}from"../chunks/index.js";import c from"./Widget.js";import n from"./BasemapGallery/BasemapGalleryViewModel.js";const g={base:"esri-basemap-gallery esri-widget esri-widget--panel-height-only",sourceLoading:"esri-basemap-gallery--source-loading",loader:"esri-basemap-gallery__loader",item:"esri-basemap-gallery__item",itemContainer:"esri-basemap-gallery__item-container",itemTitle:"esri-basemap-gallery__item-title",itemThumbnail:"esri-basemap-gallery__item-thumbnail",selectedItem:"esri-basemap-gallery__item--selected",itemLoading:"esri-basemap-gallery__item--loading",itemError:"esri-basemap-gallery__item--error",emptyMessage:"esri-widget__content--empty",widgetIcon:"esri-icon-basemap",disabled:"esri-disabled",header:"esri-widget__heading"};let h=class extends c{constructor(e,s){super(e,s),this._handles=new r,this.activeBasemap=null,this.disabled=!1,this.iconClass=g.widgetIcon,this.label=void 0,this.messages=null,this.source=null,this.view=null,this.viewModel=new n}initialize(){const e=this._handles;this.own([o(this,"viewModel.items","change",(s=>{const a="basemap-gallery-item-changes",{added:t,moved:i}=s;e.remove(a),e.add([...t,...i].map((e=>e.watch("state",(()=>this.scheduleRender())))),a),this.scheduleRender()})),e,l(this,"source",(()=>this.viewModel.load()))])}render(){const e="loading"===this.get("source.state"),s=this.disabled||"disabled"===this.get("viewModel.state"),a=this.get("viewModel.items").toArray().map(this._renderBasemapGalleryItem,this),t={[g.sourceLoading]:e,[g.disabled]:s},i=e?p("div",{class:g.loader,key:"esri-basemap-gallery__loader"}):null,r=e?null:a.length>0?p("ul",{class:g.itemContainer,key:"esri-basemap-gallery__item-container",role:"menu"},a):p("div",{class:g.emptyMessage,key:"esri-basemap-gallery__empty-message"},p("h2",{class:g.header},this.messages.noBasemaps));return p("div",{class:this.classes(g.base,t)},i,r)}_handleClick(e){const s=e.currentTarget["data-item"];"ready"===s.state&&(this.activeBasemap=s.basemap)}_renderBasemapGalleryItem(e){const s=e.get("basemap.thumbnailUrl")||i("esri/themes/base/images/basemap-toggle-64.svg"),a=e.get("basemap.title"),t=e.get("basemap.portalItem.snippet"),r=e.get("error.message")||t||a,{viewModel:o}=this,l=!this.disabled&&"ready"===o.state&&"ready"===e.state?0:-1,m=o.basemapEquals(e.basemap,this.activeBasemap),d={[g.selectedItem]:m,[g.itemLoading]:"loading"===e.state,[g.itemError]:"error"===e.state};return p("li",{"aria-selected":m.toString(),bind:this,class:this.classes(g.item,d),"data-item":e,onkeydown:this._handleClick,onclick:this._handleClick,role:"menuitem",tabIndex:l,title:r},p("img",{alt:"",class:g.itemThumbnail,src:s}),p("div",{class:g.itemTitle},a))}};e([a("viewModel.activeBasemap")],h.prototype,"activeBasemap",void 0),e([s()],h.prototype,"disabled",void 0),e([s()],h.prototype,"iconClass",void 0),e([s({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],h.prototype,"label",void 0),e([s(),d("esri/widgets/BasemapGallery/t9n/BasemapGallery")],h.prototype,"messages",void 0),e([a("viewModel.source")],h.prototype,"source",void 0),e([a("viewModel.view")],h.prototype,"view",void 0),e([s()],h.prototype,"viewModel",void 0),e([m()],h.prototype,"_handleClick",null),h=e([t("esri.widgets.BasemapGallery")],h);var u=h;export default u;
