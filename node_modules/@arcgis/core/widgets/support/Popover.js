/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
import{_ as t}from"../../chunks/tslib.es6.js";import"../../core/has.js";import{isSome as e,isNone as o}from"../../core/maybe.js";import"../../core/Logger.js";import"../../core/accessorSupport/ensureType.js";import{property as r}from"../../core/accessorSupport/decorators/property.js";import{subclass as s}from"../../core/accessorSupport/decorators/subclass.js";import"../../core/urlUtils.js";import"../../core/uuid.js";import"../../portal/support/resourceExtension.js";import{init as n}from"../../core/watchUtils.js";import{remove as p,byId as i}from"../../core/domUtils.js";import"./widgetUtils.js";import{j as h}from"../../chunks/index.js";import c from"../Widget.js";import{createPopper as l}from"@popperjs/core/dist/esm/popper.js";const d=["bottom","bottom-start","bottom-end","left","left-start","left-end","right","right-start","right-end","top","top-start","top-end"],a={base:"esri-popover",open:"esri-popover--open"},u={position:"fixed","z-index":"1000"};let m=class extends c{constructor(t,o){super(t,o),this._popper=null,this._contentNode=null,this._renderAttached=!1,this._rootNode=null,this.anchorElement=null,this.offset=[0,0],this.open=!1,this.renderContentFunction=null,this._afterRootCreate=t=>{this._rootNode=t},this._afterContentCreate=t=>{this._contentNode=t},this._updatePosition=()=>{e(this._popper)&&this._popper.update()}}initialize(){this.when((()=>{this._projector.append(document.body,this.render),this._renderAttached=!0})),this.own(n(this,["open","anchorElement"],(()=>this._buildPopper())),n(this,["placement","offset"],(()=>this._setPopperOptions())))}destroy(){this.owner=null,this.anchorElement=null,this.renderContentFunction=null,this._renderAttached&&(this._projector.detach(this.render),this._renderAttached=!1),e(this._rootNode)&&(p(this._rootNode),this._rootNode=null),this._contentNode=null,e(this._popper)&&(this._popper.destroy(),this._popper=null)}set container(t){}set owner(t){this._set("owner",t)}get placement(){return"top"}set placement(t){-1!==d.indexOf(t)?this._override("placement",t):this._clearOverride("placement")}render(){const{open:t,owner:e,renderContentFunction:o}=this;return h("div",{afterCreate:this._afterRootCreate,class:this.classes(a.base,t?a.open:null),styles:u},h("div",{afterCreate:this._afterContentCreate,afterUpdate:this._updatePosition},t&&(null==o?void 0:o.call(e))))}_buildPopper(){e(this._popper)&&(this._popper.destroy(),this._popper=null);const t=this._contentNode;if(o(t))return;if(!this.open||!this.renderContentFunction)return;const r=this._getAnchor();r&&(this._popper=l(r,t),this._setPopperOptions())}_setPopperOptions(){const{placement:t,offset:e,_popper:r}=this;o(r)||(r.setOptions({placement:t,modifiers:[{name:"offset",options:{offset:e}}]}),r.forceUpdate())}_getAnchor(){const{anchorElement:t}=this;return i("function"==typeof t?t():t)}};t([r()],m.prototype,"anchorElement",void 0),t([r()],m.prototype,"container",null),t([r()],m.prototype,"offset",void 0),t([r()],m.prototype,"open",void 0),t([r()],m.prototype,"owner",null),t([r()],m.prototype,"placement",null),t([r()],m.prototype,"renderContentFunction",void 0),m=t([s("esri.widgets.support.Popover")],m);var _=m;export default _;
