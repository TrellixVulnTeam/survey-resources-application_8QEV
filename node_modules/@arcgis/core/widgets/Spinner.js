/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
import{_ as i}from"../chunks/tslib.es6.js";import"../core/has.js";import{isNone as e}from"../core/maybe.js";import"../core/Logger.js";import"../core/accessorSupport/ensureType.js";import{property as s}from"../core/accessorSupport/decorators/property.js";import{aliasOf as o}from"../core/accessorSupport/decorators/aliasOf.js";import{subclass as t}from"../core/accessorSupport/decorators/subclass.js";import"../core/urlUtils.js";import"../core/uuid.js";import"../portal/support/resourceExtension.js";import{after as r}from"../core/promiseUtils.js";import{watch as n}from"../core/watchUtils.js";import"./support/widgetUtils.js";import{j as p}from"../chunks/index.js";import a from"./Widget.js";import l from"./Spinner/SpinnerViewModel.js";const c={base:"esri-spinner",spinnerStart:"esri-spinner--start",spinnerFinish:"esri-spinner--finish"};let m=class extends a{constructor(i,e){super(i,e),this._animationDelay=500,this._animationPromise=null,this.location=null,this.view=null,this.viewModel=new l,this.visible=!1}initialize(){this.own([n(this,"visible",(i=>this._visibleChange(i)))])}destroy(){this._animationPromise=null}show(i){const{location:e,promise:s}=i;e&&(this.viewModel.location=e),this.visible=!0;const o=()=>this.hide();s&&s.catch((()=>{})).then(o)}hide(){this.visible=!1}render(){const{visible:i}=this,{screenLocation:e}=this.viewModel,s=!!e,o=i&&s,t=!i&&s,r={[c.spinnerStart]:o,[c.spinnerFinish]:t},n=this._getPositionStyles();return p("div",{class:this.classes(c.base,r),styles:n})}_visibleChange(i){if(i)return void(this.viewModel.screenLocationEnabled=!0);const e=r(this._animationDelay);this._animationPromise=e,e.catch((()=>{})).then((()=>{this._animationPromise===e&&(this.viewModel.screenLocationEnabled=!1,this._animationPromise=null)}))}_getPositionStyles(){const{screenLocation:i,view:s}=this.viewModel;if(!s||e(i))return{};const{padding:o}=s;return{left:i.x-o.left+"px",top:i.y-o.top+"px"}}};i([o("viewModel.location")],m.prototype,"location",void 0),i([o("viewModel.view")],m.prototype,"view",void 0),i([s({type:l})],m.prototype,"viewModel",void 0),i([o("viewModel.visible")],m.prototype,"visible",void 0),m=i([t("esri.widgets.Spinner")],m);var h=m;export default h;
