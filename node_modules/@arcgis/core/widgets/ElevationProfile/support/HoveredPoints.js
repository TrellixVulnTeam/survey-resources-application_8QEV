/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
import{_ as o}from"../../../chunks/tslib.es6.js";import"../../../core/has.js";import{applySome as e,removeMaybe as t}from"../../../core/maybe.js";import"../../../core/Logger.js";import"../../../core/accessorSupport/ensureType.js";import{property as r}from"../../../core/accessorSupport/decorators/property.js";import{subclass as s}from"../../../core/accessorSupport/decorators/subclass.js";import"../../../core/urlUtils.js";import"../../../core/uuid.js";import"../../../portal/support/resourceExtension.js";import{autorun as i}from"../../../core/accessorSupport/trackingUtils.js";import n from"../../../core/Accessor.js";import c from"../../../core/Collection.js";import p from"../../support/AnchorElementViewModel.js";import{HOVERED_POINTS_STYLE as d}from"./constants.js";let a=class extends n{constructor(o){super(o),this._hoveredPoints=new c}initialize(){this._updateScreenLocationsHandle=i((()=>{this._hoveredPoints.forEach((({anchor:o,element:t})=>{e(o.screenLocation,(({x:o,y:e})=>{t.style.transform=`translate(${o}px, ${e}px)`}))}))}))}destroy(){this._updateScreenLocationsHandle=t(this._updateScreenLocationsHandle),this._hoveredPoints.drain((o=>this._destroyHoveredPoint(o)))}update(o){const e=this.view,t=this._hoveredPoints,r=o.length;for(;this._hoveredPoints.length>r;)this._destroyHoveredPoint(this._hoveredPoints.pop());for(;this._hoveredPoints.length<r;){const o=this._makeHoveredPoint();t.push(o),e.surface.appendChild(o.element)}for(let s=0;s<r;++s){const e=t.getItemAt(r-1-s),i=o[s];this._updateHoveredPoint(e,i)}}_makeHoveredPoint(){const{size:o,borderStyle:e,borderColor:t,borderWidth:r,boxShadow:s}=d,i=this.view,n=new p({view:i,screenLocationEnabled:!0}),c=document.createElement("div"),a=c.style;return a.position="absolute",a.top="0",a.left="0",a.contain="strict",a.boxSizing="border-box",a.width=`${o}px`,a.height=`${o}px`,a.marginTop=`-${o/2}px`,a.marginLeft=`-${o/2}px`,a.border=`${e} ${r}px ${t}`,a.borderRadius=`${o}px`,a.boxShadow=s,{anchor:n,element:c}}_updateHoveredPoint({anchor:o,element:e},t){o.screenLocationEnabled=!0,o.location=t.hoveredPoint;const r=e.style;r.display="block",r.background=t.color.toCss()}_destroyHoveredPoint({anchor:o,element:e}){o.destroy(),this.view.surface.removeChild(e)}};o([r()],a.prototype,"view",void 0),o([r()],a.prototype,"_hoveredPoints",void 0),a=o([s("esri.widgets.ElevationProfile.support.HoveredPoints")],a);export{a as HoveredPoints};
