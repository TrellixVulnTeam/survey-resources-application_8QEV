/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
import e from"../../core/Error.js";import r from"../../PopupTemplate.js";import{fetchMessageBundle as n}from"../../intl/messages.js";import{getContentFromFieldInfos as a,hasNormalizedField as s,getFieldAndExpressionInfos as t}from"./support/utils.js";async function i(r){const{layer:n,renderer:a}=r;await n.load();const s=a||n.renderer;if("unique-value"!==s.type)throw new e("unique-values-popup:invalid-parameters","renderer.type must be 'unique-value'");return{layer:n,renderer:s}}async function o(e,n,s="divide"){const{fieldInfos:i,expressionInfos:o}=await t({renderer:e,layer:n,normFieldExpressionTemplate:s});return new r({content:await a(n,{fieldInfos:i,expressionInfos:o}),fieldInfos:i,expressionInfos:o})}async function u(e){const[{renderer:r,layer:a},t]=await Promise.all([i(e),n("esri/smartMapping/t9n/smartMapping")]),u={name:"unique-values",title:t.uniqueValues,value:await o(r,a)},p=[];return s(r)&&p.push({name:"unique-values-percent",title:t.uniqueValuesNormFieldAsPercent,value:await o(r,a,"percentage")}),{primaryTemplate:u,secondaryTemplates:p}}export{u as getTemplates};
