/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
import e from"../../core/Error.js";import r from"../../PopupTemplate.js";import{fetchMessageBundle as n}from"../../intl/messages.js";import{getPrimaryVisualVariables as s,getContentFromFieldInfos as t,hasNormalizedField as i,getFieldAndExpressionInfos as a}from"./support/utils.js";async function o(r){const{layer:n,renderer:s}=r;await n.load();const t=s||n.renderer;if("simple"!==t.type)throw new e("simple-popup:invalid-parameters","renderer.type must be 'simple'");return{layer:n,renderer:t}}async function p(e,n,s="divide"){const{fieldInfos:i,expressionInfos:o}=await a({renderer:e,layer:n,normFieldExpressionTemplate:s});return new r({content:await t(n,{fieldInfos:i,expressionInfos:o}),expressionInfos:o,fieldInfos:i})}async function l(e){const[{renderer:r,layer:t},a]=await Promise.all([o(e),n("esri/smartMapping/t9n/smartMapping")]),l=[];if(!s(r).length)return null;const m={name:"simple",title:a.simple,value:await p(r,t)};return i(r)&&l.push({name:"simple-percent",title:a.simpleNormFieldAsPercent,value:await p(r,t,"percentage")}),{primaryTemplate:m,secondaryTemplates:l}}export{l as getTemplates};
