/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
import{isSome as e}from"../../../core/maybe.js";import n from"../../../core/Error.js";import{isNumericField as t,numericTypes as i}from"../../../layers/support/fieldUtils.js";function o(e){const n=e.field,t=e.normalizationType,i=e.normalizationField;let o;return"log"===t?o="(NOT "+n+" = 0)":"field"===t?o="(NOT "+i+" = 0)":"natural-log"!==t&&"square-root"!==t||(o=`(${n} > 0)`),o}function r(e,t){return new n(e,t)}function l(e,n,t){const i=null!=n?e+" >= "+n:"",o=null!=t?e+" <= "+t:"";let r="";return r=i&&o?u(i,o):i||o,r?"("+r+")":""}function s(e,n,t,i){let o=null;return n?n.name!==e.objectIdField&&-1!==i.indexOf(n.type)||(o=r(t,"'field' should be one of these types: "+i.join(","))):o=r(t,"'field' is not defined in the layer schema"),o}function f(e,n,o){let l;return n?n.name!==e.objectIdField&&t(n)||(l=r(o,"'field' should be one of these numeric types: "+i.join(","))):l=r(o,"'field' is not defined in the layer schema"),l}function u(n,t){let i=e(n)?n:"";return e(t)&&t&&(i=i?"("+i+") AND ("+t+")":t),i}function d(e,n,t){const i=a({layer:e,fields:n});if(i.length)return r(t,"Unknown fields: "+i.join(", ")+". You can only use fields defined in the layer schema");const o=c({layer:e,fields:n});return o.length?r(t,"Unsupported fields: "+o.join(", ")+". You can only use fields that can be fetched i.e. AdapterFieldUsageInfo.supportsStatistics must be true"):void 0}function a(e){const n=e.layer;return e.fields.filter((e=>!n.getField(e)))}function c(e){const n=e.layer;return e.fields.filter((e=>{const t=n.getFieldUsageInfo(e);return!t||!t.supportsStatistics}))}export{r as createError,l as getRangeExpr,o as getSQLFilterForNormalization,u as mergeWhereClauses,d as verifyBasicFieldValidity,s as verifyFieldType,f as verifyNumericField};
